!function(){"use strict";class e{constructor(e,t,s,n,i,o){let{name:r,link:a,likes:l,_id:u,owner:c}=e;this._owner=c,this._name=r,this._link=a,this._templateSelector=t,this._handleCardClick=s,this._handleDeleteClick=n,this._handleHeartClick=i,this._cardId=u,this._userId=o,this._likes=l,this._likesNum=l?l.length:0}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_handleImageClick(e){e.preventDefault(),this._handleCardClick(e.target.src,this._name)}_handleDeleteIconClick(e){this._handleDeleteClick(e,this._cardId)}_handleLikeClick(e){e.preventDefault(),this._handleHeartClick(this._cardId,e.target.classList.contains("element__like_active"),this._updateCard.bind(this))}_setEventListeners(){this._imageElement.addEventListener("click",(e=>this._handleImageClick(e))),this._deleteElement.addEventListener("click",(e=>{e.preventDefault(),this._handleDeleteIconClick(this._deleteElement.closest(".element"))})),this._likes.forEach((e=>{e._id===this._userId&&this._likeElement.classList.add("element__like_active")})),this._likeElement.addEventListener("click",(e=>this._handleLikeClick(e)))}getCard(){return this._element=this._getTemplate(),this._imageElement=this._element.querySelector(".element__image"),this._nameElement=this._element.querySelector(".element__box").querySelector(".element__name"),this._deleteElement=this._element.querySelector(".element__delete-button"),this._likeElement=this._element.querySelector(".element__like"),this._likesNumElement=this._element.querySelector(".element__count"),this._userId===this._owner._id&&(this._deleteElement.style.visibility="visible"),this._imageElement.src=this._link,this._imageElement.alt=this._name,this._nameElement.textContent=this._name,this._likesNumElement.textContent=this._likesNum,this._setEventListeners(),this._element}_updateCard(e){this._likesNum=e,this._likeElement.classList.toggle("element__like_active"),this._likesNumElement.textContent=this._likesNum}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),this._errorElement.textContent=t,e.classList.add(this._inputErrorClass)}_hideInputError(e){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),this._errorElement.textContent="",e.classList.remove(this._inputErrorClass)}disableButton(){this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._inactiveButtonClass)}_enableButton(){this._buttonElement.disabled=!1,this._buttonElement.classList.remove(this._inactiveButtonClass)}_checkIfValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_checkIfFormValid(){return this._inputsList.every((e=>e.validity.valid&&""!==e.value))}_toggleSubmitBtnState(){this._checkIfFormValid()?this._enableButton():this.disableButton()}_setEventListeners(){this._inputsList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._inputsList.forEach((e=>{e.addEventListener("input",(t=>{t.preventDefault(),this._toggleSubmitBtnState(),this._checkIfValid(e)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n{constructor(e){s(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.closePopup()})),s(this,"_handleOverlayClick",(e=>{e.target.classList.contains("popup")&&this.closePopup()})),this._popup=document.querySelector(e)}closePopup(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popup.removeEventListener("click",this._handleOverlayClick)}openPopup(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose),this._popup.addEventListener("click",this._handleOverlayClick)}_addCloseOnClickEvent(){this._closeBtn=this._popup.querySelector(".popup__close"),this._closeBtn.addEventListener("click",(e=>{e.preventDefault(),this.closePopup()}))}setEventListeners(){this._addCloseOnClickEvent()}}class i extends n{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._buttonValue=this._popup.querySelector(".popup__button").value,this._inputList=this._popup.querySelectorAll(".popup__input"),this._button=this._popup.querySelector(".popup__button")}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this.renderLoading(!0),this._handleFormSubmit(this._getInputValues(),this._element,this._id)}))}setSubmitData(e,t){this._element=e,this._id=t}renderLoading(e){this._button.value=e?"Saving...":this._buttonValue}closePopup(){super.closePopup(),this._form.reset()}}const o=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-button"),a=document.querySelector(".popup__input_type_name"),l=document.querySelector(".popup__input_type_hobby"),u=document.querySelector(".popup__form_type_profile"),c=document.querySelector(".popup__form_type_card"),h=document.querySelector(".popup__form_type_avatar"),_=(document.querySelector(".profile__name"),document.querySelector(".profile__interest"),document.querySelector(".profile__overlay-container")),p={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},d=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.url=t,this.headers=s}loadUserInfo(){return fetch("".concat(this.url,"/users/me"),{headers:{authorization:this.headers.authorization}}).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getInitialCards(){return fetch("".concat(this.url,"/cards"),{headers:{authorization:this.headers.authorization}}).then(this._checkResponse)}editProfileData(e,t){return fetch("".concat(this.url,"/users/me"),{method:"PATCH",headers:{authorization:this.headers.authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}addNewCard(e,t){return fetch("".concat(this.url,"/cards"),{method:"POST",headers:{authorization:this.headers.authorization,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch("".concat(this.url,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this.headers.authorization,"Content-Type":"application/json"},body:JSON.stringify({likes:[],_id:e})}).then(this._checkResponse)}likeCard(e){return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this.headers.authorization,"Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then(this._checkResponse)}unlikeCard(e){return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this.headers.authorization,"Content-Type":"application/json"},body:JSON.stringify({_id:e})}).then(this._checkResponse)}changeProfileAvatar(e){return fetch("".concat(this.url,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this.headers.authorization,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"82cfb778-0110-4074-beef-5e31af26dd47"}}),m=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(e){this._items=e,this._items.forEach((e=>{this._renderer(e)}))}}({items:[],renderer:e=>{q(e)}},".elements"),f=new class{constructor(e){let{userNameSelector:t,userJobSelector:s,userAvatarSelector:n}=e;this._userName=document.querySelector(t),this._userJob=document.querySelector(s),this._userAvatar=document.querySelector(n)}getUserInfo(){return{userName:this._userName.textContent,userJob:this._userJob.textContent,userId:this._userId,userAvatar:this._userAvatar.src}}setUserInfo(e,t,s,n){this._userName.textContent=e,this._userJob.textContent=t,this._userId=s,this._userAvatar.src=n}}({userNameSelector:".profile__name",userJobSelector:".profile__interest",userAvatarSelector:".profile__image"}),E=new i(".popup_type_confirm",(function(e,t,s){let{}=e;d.deleteCard(s).then((e=>{t.remove(),E.closePopup()})).catch((e=>console.log(e))).finally((()=>E.renderLoading(!1)))}));E.setEventListeners();const v=new i(".popup_type_avatar",(function(e){const{url:t}=e;d.changeProfileAvatar(t).then((e=>{f.setUserInfo(e.name,e.about,e._id,e.avatar),v.closePopup()})).catch((e=>console.log(e))).finally((()=>v.renderLoading(!1)))}));v.setEventListeners();const y=new class extends n{constructor(e){super(e),this._popupImageElement=this._popup.querySelector(".popup__card-image"),this._popupNameElement=this._popup.querySelector(".popup__name")}openPopup(e,t){super.openPopup(),this._addImageAndCaption(e,t)}_addImageAndCaption(e,t){this._popupImageElement.src=e,this._popupImageElement.alt=t,this._popupNameElement.textContent=t}}(".popup_type_image");y.setEventListeners();const k=new i(".popup_type_card",(function(e){const{title:t,image_link:s}=e;d.addNewCard(t,s).then((e=>{q(e),k.closePopup()})).catch((e=>console.log(e))).finally((()=>k.renderLoading(!1)))}));k.setEventListeners();const b=new i(".popup_type_profile",(function(e){const{name:t,hobby:s}=e;d.editProfileData(t,s).then((e=>{f.setUserInfo(e.name,e.about,e._id,e.avatar),b.closePopup()})).catch((e=>console.log(e))).finally((()=>b.renderLoading(!1)))}));b.setEventListeners();const C=new t(p,c);C.enableValidation();const S=new t(p,h);function g(e,t,s){t?d.unlikeCard(e).then((e=>{s(e.likes.length)})).catch((e=>console.log(e))):d.likeCard(e).then((e=>{s(e.likes.length)})).catch((e=>console.log(e)))}function L(e,t){y.openPopup(e,t)}function I(e,t){E.setSubmitData(e,t),E.openPopup()}function q(t){const s=new e(t,"#element",L,I,g,f.getUserInfo().userId).getCard();m.addItem(s)}S.enableValidation(),new t(p,u).enableValidation(),r.addEventListener("click",(()=>{k.openPopup(),C.disableButton()})),o.addEventListener("click",(()=>{b.openPopup(),function(){const{userName:e,userJob:t}=f.getUserInfo();a.value=e,l.value=t}()})),_.addEventListener("click",(()=>{v.openPopup(),S.disableButton()})),Promise.all([d.loadUserInfo(),d.getInitialCards()]).then((e=>{let[t,s]=e;f.setUserInfo(t.name,t.about,t._id,t.avatar),m.renderItems(s)})).catch((e=>{console.log(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RixpQkFBaUIsU0FBUyxLQUNoRHlKLEVBQVl6RixZQUNac0csRUFBb0I5SCxtQkFHdEIrRCxRQUFRc0UsSUFBSSxDQUFDbEYsRUFBSUksZUFBZ0JKLEVBQUllLG9CQUNsQ1IsTUFBSyxJQUF1QixJQUFyQjRFLEVBQVVDLEdBQVcsRUFFM0IzQyxFQUFTVyxZQUNQK0IsRUFBU25OLEtBQ1RtTixFQUFTbEUsTUFDVGtFLEVBQVNoTixJQUNUZ04sRUFBU3hELFFBR1hDLEVBQWdCUyxZQUFZK0MsTUFFN0IzQixPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FQSS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeyBuYW1lLCBsaW5rLCBsaWtlcywgX2lkLCBvd25lciB9LFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrLFxyXG4gICAgdXNlcklkXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9vd25lciA9IG93bmVyO1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUhlYXJ0Q2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl9jYXJkSWQgPSBfaWQ7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgdGhpcy5fbGlrZXNOdW0gPSBsaWtlcyA/IGxpa2VzLmxlbmd0aCA6IDA7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50XCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlSW1hZ2VDbGljayhldnQpIHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKGV2dC50YXJnZXQuc3JjLCB0aGlzLl9uYW1lKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVEZWxldGVJY29uQ2xpY2soZWxlbWVudCkge1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2soZWxlbWVudCwgdGhpcy5fY2FyZElkKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQ2xpY2soZXZ0KSB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZUhlYXJ0Q2xpY2soXHJcbiAgICAgIHRoaXMuX2NhcmRJZCxcclxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJlbGVtZW50X19saWtlX2FjdGl2ZVwiKSxcclxuICAgICAgdGhpcy5fdXBkYXRlQ2FyZC5iaW5kKHRoaXMpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKGV2dClcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUljb25DbGljayh0aGlzLl9kZWxldGVFbGVtZW50LmNsb3Nlc3QoXCIuZWxlbWVudFwiKSk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX2xpa2VzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgaWYgKGVsZW1lbnQuX2lkID09PSB0aGlzLl91c2VySWQpIHtcclxuICAgICAgICB0aGlzLl9saWtlRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZWxlbWVudF9fbGlrZV9hY3RpdmVcIik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2xpa2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2soZXZ0KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldENhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fYm94XCIpXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX25hbWVcIik7XHJcbiAgICB0aGlzLl9kZWxldGVFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5lbGVtZW50X19kZWxldGUtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9saWtlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saWtlXCIpO1xyXG4gICAgdGhpcy5fbGlrZXNOdW1FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2NvdW50XCIpO1xyXG5cclxuICAgIGlmICh0aGlzLl91c2VySWQgPT09IHRoaXMuX293bmVyLl9pZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcclxuICAgIH1cclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9saWtlc051bUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlc051bTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbiAgX3VwZGF0ZUNhcmQobGlrZU51bSkge1xyXG4gICAgdGhpcy5fbGlrZXNOdW0gPSBsaWtlTnVtO1xyXG4gICAgdGhpcy5fbGlrZUVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcImVsZW1lbnRfX2xpa2VfYWN0aXZlXCIpO1xyXG4gICAgdGhpcy5fbGlrZXNOdW1FbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNOdW07XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJZlZhbGlkKGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9jaGVja0lmRm9ybVZhbGlkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0c0xpc3QuZXZlcnkoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkICYmIGlucHV0RWxlbWVudC52YWx1ZSAhPT0gXCJcIjtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZVN1Ym1pdEJ0blN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2NoZWNrSWZGb3JtVmFsaWQoKSkge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dHNMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dHNMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChldnQpID0+IHtcclxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLl90b2dnbGVTdWJtaXRCdG5TdGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSWZWYWxpZChpbnB1dEVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2VQb3B1cCgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNsb3NlUG9wdXAoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayk7XHJcbiAgfVxyXG5cclxuICBvcGVuUG9wdXAoKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlT3ZlcmxheUNsaWNrID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikpIHtcclxuICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2FkZENsb3NlT25DbGlja0V2ZW50KCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZVwiKTtcclxuICAgIHRoaXMuX2Nsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9hZGRDbG9zZU9uQ2xpY2tFdmVudCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fYnV0dG9uVmFsdWUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIikudmFsdWU7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbnB1dFwiKTtcclxuICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuXHJcbiAgICAvLyBBZGQgdGhlIHZhbHVlcyBvZiB0aGUgZmllbGRzIHRvIHRoaXMgb2JqZWN0XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgdGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSB2YWx1ZXMgb2JqZWN0XHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIC8vIGNhbGwgaGFuZGxlRm9ybVN1Ym1pdCBhbmQgcGFzcyB0aGUgcmVzdWx0IG9mIGdldElucHV0VmFsdWVzKClcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpLCB0aGlzLl9lbGVtZW50LCB0aGlzLl9pZCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdERhdGEoZWxlbWVudCwgaWQpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgdGhpcy5faWQgPSBpZDtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbi52YWx1ZSA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b24udmFsdWUgPSB0aGlzLl9idXR0b25WYWx1ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsb3NlUG9wdXAoKSB7XHJcbiAgICBzdXBlci5jbG9zZVBvcHVwKCk7XHJcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IHByb2ZpbGVFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUFkZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVJbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVJbnB1dEhvYmJ5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW5wdXRfdHlwZV9ob2JieVwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtX3R5cGVfcHJvZmlsZVwiKTtcclxuY29uc3QgY2FyZFBvcHVwRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1fdHlwZV9jYXJkXCIpO1xyXG5jb25zdCBhdmF0YXJQb3B1cEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19mb3JtX3R5cGVfYXZhdGFyXCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVJbnRlcmVzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW50ZXJlc3RcIik7XHJcblxyXG5jb25zdCBwcm9maWxlT3ZlcmxheUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fb3ZlcmxheS1jb250YWluZXJcIlxyXG4pO1xyXG5cclxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8vIHNldHRpbmdzIGZvciB2YWxpZGF0aW9uXHJcbmNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgcHJvZmlsZUlucHV0TmFtZSxcclxuICBwcm9maWxlSW5wdXRIb2JieSxcclxuICBjYXJkUG9wdXBGb3JtLFxyXG4gIHByb2ZpbGVQb3B1cEZvcm0sXHJcbiAgaW5pdGlhbENhcmRzLFxyXG4gIHByb2ZpbGVBZGRCdG4sXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgcHJvZmlsZU5hbWUsXHJcbiAgcHJvZmlsZUludGVyZXN0LFxyXG4gIHNldHRpbmdzLFxyXG4gIHByb2ZpbGVPdmVybGF5Q29udGFpbmVyLFxyXG4gIGF2YXRhclBvcHVwRm9ybSxcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQVBJIGZyb20gXCIuLy4uL2NvbXBvbmVudHMvQVBJXCI7XHJcbmltcG9ydCB7XHJcbiAgcHJvZmlsZUlucHV0TmFtZSxcclxuICBwcm9maWxlSW5wdXRIb2JieSxcclxuICBwcm9maWxlQWRkQnRuLFxyXG4gIHByb2ZpbGVQb3B1cEZvcm0sXHJcbiAgcHJvZmlsZUVkaXRCdG4sXHJcbiAgY2FyZFBvcHVwRm9ybSxcclxuICBzZXR0aW5ncyxcclxuICBwcm9maWxlT3ZlcmxheUNvbnRhaW5lcixcclxuICBhdmF0YXJQb3B1cEZvcm0sXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuLy8gQVBJXHJcbmNvbnN0IGFwaSA9IG5ldyBBUEkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiODJjZmI3NzgtMDExMC00MDc0LWJlZWYtNWUzMWFmMjZkZDQ3XCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vLyBlbGVtZW50cyBzZWN0aW9uIGluc3RhbmNlXHJcbmNvbnN0IGVsZW1lbnRzU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBbXSxcclxuICAgIHJlbmRlcmVyOiAoY2FyZEl0ZW0pID0+IHtcclxuICAgICAgcmVuZGVyQ2FyZChjYXJkSXRlbSk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIuZWxlbWVudHNcIlxyXG4pO1xyXG5cclxuLy8gdXNlckluZm9cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIHVzZXJOYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICB1c2VySm9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ludGVyZXN0XCIsXHJcbiAgdXNlckF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxyXG59KTtcclxuXHJcbmNvbnN0IGNvbmZpcm1EZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfY29uZmlybVwiLFxyXG4gIGhhbmRsZUNvbmZpcm1Gb3JtU3VibWl0XHJcbik7XHJcbmNvbmZpcm1EZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gYXZhdGFyIHBvcHVwXHJcbmNvbnN0IGF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIucG9wdXBfdHlwZV9hdmF0YXJcIixcclxuICBoYW5kbGVBdmF0YXJQaWN0dXJlU3VibWl0XHJcbik7XHJcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyBjYXJkIHdpdGggaW1hZ2UgcG9wdXAgaW5zdGFuY2VcclxuY29uc3QgY2FyZEltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZV9pbWFnZVwiKTtcclxuY2FyZEltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIGNhcmQgcG9wdXAgaW5zdGFuY2Ugb2YgdGhlIFBvcHVwV2l0aEZvcm0gY2xhc3NcclxuY29uc3QgY2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIucG9wdXBfdHlwZV9jYXJkXCIsIGhhbmRsZUNhcmRGb3JtU3VibWl0KTtcclxuY2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLyBwcm9maWxlIHBvcHVwIGluc3RhbmNlIG9mIHRoZSBQb3B1cFdpdGhGb3JtIGNsYXNzXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfcHJvZmlsZVwiLFxyXG4gIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0XHJcbik7XHJcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gY2FyZCBmb3JtIHZhbGlkYXRvclxyXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBjYXJkUG9wdXBGb3JtKTtcclxuY2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8gYXZhdGFyIGZvcm0gdmFsaWRhdG9yXHJcbmNvbnN0IGF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYXZhdGFyUG9wdXBGb3JtKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBwcm9maWxlIGZvcm0gdmFsaWRhdG9yXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHByb2ZpbGVQb3B1cEZvcm0pO1xyXG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vLyBhZGQgYSBjbGljayBldmVudCBsaXN0ZW5lciBmb3IgdGhlIGFkZCBidXR0b25cclxucHJvZmlsZUFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNhcmRQb3B1cC5vcGVuUG9wdXAoKTtcclxuICBjYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxuLy8gYWRkIGEgY2xpY2sgZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBlZGl0IGJ1dHRvblxyXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVQb3B1cC5vcGVuUG9wdXAoKTtcclxuICBmaWxsUHJvZmlsZUlucHV0cygpO1xyXG59KTtcclxuXHJcbi8vIGF2YXRhciBmb3JtIHN1Ym1pdCBoYW5kbGVyXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclBpY3R1cmVTdWJtaXQoZGF0YSkge1xyXG4gIGNvbnN0IHsgdXJsIH0gPSBkYXRhO1xyXG5cclxuICBhcGlcclxuICAgIC5jaGFuZ2VQcm9maWxlQXZhdGFyKHVybClcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCwgcmVzLl9pZCwgcmVzLmF2YXRhcik7XHJcbiAgICAgIGF2YXRhclBvcHVwLmNsb3NlUG9wdXAoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IGF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcclxufVxyXG5cclxuLy8gY2FyZCBmb3JtIHN1Ym1pdCBoYW5kbGVyXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGRhdGEpIHtcclxuICBjb25zdCB7IHRpdGxlLCBpbWFnZV9saW5rIH0gPSBkYXRhO1xyXG5cclxuICAvLyBhZGQgYSBuZXcgY2FyZCB0byB0aGUgc2VydmVyXHJcbiAgYXBpXHJcbiAgICAuYWRkTmV3Q2FyZCh0aXRsZSwgaW1hZ2VfbGluaylcclxuICAgIC50aGVuKChjYXJkKSA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQoY2FyZCk7XHJcbiAgICAgIGNhcmRQb3B1cC5jbG9zZVBvcHVwKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAuZmluYWxseSgoKSA9PiBjYXJkUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSkpO1xyXG59XHJcblxyXG4vLyBsaWtlIGNsaWNrIGhhbmRsZXJcclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGlkLCBsaWtlZCwgdXBkYXRlQ2FyZCkge1xyXG4gIGlmIChsaWtlZCkge1xyXG4gICAgYXBpXHJcbiAgICAgIC51bmxpa2VDYXJkKGlkKVxyXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgIHVwZGF0ZUNhcmQoZGF0YS5saWtlcy5sZW5ndGgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAubGlrZUNhcmQoaWQpXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgdXBkYXRlQ2FyZChkYXRhLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcbn1cclxuXHJcbi8vIHByb2ZpbGUgZm9ybSBzdWJtaXQgaGFuZGxlclxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChkYXRhKSB7XHJcbiAgY29uc3QgeyBuYW1lLCBob2JieSB9ID0gZGF0YTtcclxuXHJcbiAgLy8gdXBhZHRlIHByb2ZpbGUgZGF0YSBpbiB0aGUgc2VydmVyXHJcbiAgYXBpXHJcbiAgICAuZWRpdFByb2ZpbGVEYXRhKG5hbWUsIGhvYmJ5KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0LCByZXMuX2lkLCByZXMuYXZhdGFyKTtcclxuICAgICAgcHJvZmlsZVBvcHVwLmNsb3NlUG9wdXAoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XHJcbn1cclxuLy8gZGVsZXRlIGEgY2FyZFxyXG5mdW5jdGlvbiBoYW5kbGVDb25maXJtRm9ybVN1Ym1pdCh7fSwgZWxlbWVudCwgaWQpIHtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKGlkKVxyXG4gICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICBlbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICBjb25maXJtRGVsZXRlUG9wdXAuY2xvc2VQb3B1cCgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gY29uZmlybURlbGV0ZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcclxufVxyXG5cclxuLy8gY2FyZCBjbGljayBoYW5kbGVyXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhzcmMsIG5hbWUpIHtcclxuICBjYXJkSW1hZ2VQb3B1cC5vcGVuUG9wdXAoc3JjLCBuYW1lKTtcclxufVxyXG5cclxuLy8gb3BlbiBjb25maXJtIHBvcHVwXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUljb25DbGljayhlbGVtZW50LCBpZCkge1xyXG4gIGNvbmZpcm1EZWxldGVQb3B1cC5zZXRTdWJtaXREYXRhKGVsZW1lbnQsIGlkKTtcclxuICBjb25maXJtRGVsZXRlUG9wdXAub3BlblBvcHVwKCk7XHJcbn1cclxuXHJcbi8vIHJlbmRlcmluZyBhIGNhcmRcclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgXCIjZWxlbWVudFwiLFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlSWNvbkNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrLFxyXG4gICAgdXNlckluZm8uZ2V0VXNlckluZm8oKS51c2VySWRcclxuICApO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZXRDYXJkKCk7XHJcbiAgZWxlbWVudHNTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG59XHJcblxyXG4vLyBhIGZ1bmN0aW9uIHRvIGZpbGwgdGhlIGlucHV0cyBhZnRlciByZXNldHRpbmcgdGhlIHByb2ZpbGUgZm9ybVxyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUlucHV0cygpIHtcclxuICBjb25zdCB7IHVzZXJOYW1lLCB1c2VySm9iIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVJbnB1dE5hbWUudmFsdWUgPSB1c2VyTmFtZTtcclxuICBwcm9maWxlSW5wdXRIb2JieS52YWx1ZSA9IHVzZXJKb2I7XHJcbn1cclxuXHJcbnByb2ZpbGVPdmVybGF5Q29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyUG9wdXAub3BlblBvcHVwKCk7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5sb2FkVXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcclxuICAgIC8vIHNldCB1c2VySW5mbyBmcm9tIHRoZSBzZXJ2ZXIgcmVzcG9uc2VcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKFxyXG4gICAgICB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICB1c2VyRGF0YS5hYm91dCxcclxuICAgICAgdXNlckRhdGEuX2lkLFxyXG4gICAgICB1c2VyRGF0YS5hdmF0YXJcclxuICAgICk7XHJcbiAgICAvLyBzZXQgaW5pdGlhbENhcmRzIGJhc2VkIG9uIHRoZSBzZXJ2ZXIgcmVzcG9uc2VcclxuICAgIGVsZW1lbnRzU2VjdGlvbi5yZW5kZXJJdGVtcyhjYXJkcyk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQVBJIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy51cmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIGxvYWRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLnVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHsgYXV0aG9yaXphdGlvbjogdGhpcy5oZWFkZXJzLmF1dGhvcml6YXRpb24gfSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycy5hdXRob3JpemF0aW9uIH0sXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFByb2ZpbGVEYXRhKG5hbWUsIGFib3V0KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycy5hdXRob3JpemF0aW9uLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBhYm91dDogYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQobmFtZSwgbGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycy5hdXRob3JpemF0aW9uLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBsaW5rOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLmhlYWRlcnMuYXV0aG9yaXphdGlvbixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGxpa2VzOiBbXSxcclxuICAgICAgICBfaWQ6IGlkLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5oZWFkZXJzLmF1dGhvcml6YXRpb24sXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBfaWQ6IGlkLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gIHVubGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLnVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycy5hdXRob3JpemF0aW9uLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgX2lkOiBpZCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuICBjaGFuZ2VQcm9maWxlQXZhdGFyKGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLnVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuaGVhZGVycy5hdXRob3JpemF0aW9uLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyB1c2VyTmFtZVNlbGVjdG9yLCB1c2VySm9iU2VsZWN0b3IsIHVzZXJBdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl91c2VySm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VySm9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdXNlckF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlckF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdXNlck5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICB1c2VySm9iOiB0aGlzLl91c2VySm9iLnRleHRDb250ZW50LFxyXG4gICAgICB1c2VySWQ6IHRoaXMuX3VzZXJJZCxcclxuICAgICAgdXNlckF2YXRhcjogdGhpcy5fdXNlckF2YXRhci5zcmMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iLCBpZCwgcHJvZmlsZUltYWdlTGluaykge1xyXG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fdXNlckpvYi50ZXh0Q29udGVudCA9IGpvYjtcclxuICAgIHRoaXMuX3VzZXJJZCA9IGlkO1xyXG4gICAgdGhpcy5fdXNlckF2YXRhci5zcmMgPSBwcm9maWxlSW1hZ2VMaW5rO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXJkLWltYWdlXCIpO1xyXG4gICAgdGhpcy5fcG9wdXBOYW1lRWxlbWVudCA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX25hbWVcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuUG9wdXAoc3JjLCBuYW1lKSB7XHJcbiAgICBzdXBlci5vcGVuUG9wdXAoKTtcclxuICAgIHRoaXMuX2FkZEltYWdlQW5kQ2FwdGlvbihzcmMsIG5hbWUpO1xyXG4gIH1cclxuXHJcbiAgX2FkZEltYWdlQW5kQ2FwdGlvbihzcmMsIG5hbWUpIHtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VFbGVtZW50LnNyYyA9IHNyYztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2VFbGVtZW50LmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwidXNlcklkIiwibmFtZSIsImxpbmsiLCJsaWtlcyIsIl9pZCIsIm93bmVyIiwidGhpcyIsIl9vd25lciIsIl9uYW1lIiwiX2xpbmsiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlSGVhcnRDbGljayIsIl9jYXJkSWQiLCJfdXNlcklkIiwiX2xpa2VzIiwiX2xpa2VzTnVtIiwibGVuZ3RoIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJzcmMiLCJfaGFuZGxlRGVsZXRlSWNvbkNsaWNrIiwiZWxlbWVudCIsIl9oYW5kbGVMaWtlQ2xpY2siLCJjbGFzc0xpc3QiLCJjb250YWlucyIsIl91cGRhdGVDYXJkIiwiYmluZCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9pbWFnZUVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUVsZW1lbnQiLCJjbG9zZXN0IiwiZm9yRWFjaCIsIl9saWtlRWxlbWVudCIsImFkZCIsImdldENhcmQiLCJfZWxlbWVudCIsIl9uYW1lRWxlbWVudCIsIl9saWtlc051bUVsZW1lbnQiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJhbHQiLCJ0ZXh0Q29udGVudCIsImxpa2VOdW0iLCJ0b2dnbGUiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfYnV0dG9uRWxlbWVudCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsIl9lcnJvckVsZW1lbnQiLCJpZCIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsIl9lbmFibGVCdXR0b24iLCJfY2hlY2tJZlZhbGlkIiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2NoZWNrSWZGb3JtVmFsaWQiLCJfaW5wdXRzTGlzdCIsImV2ZXJ5IiwidmFsdWUiLCJfdG9nZ2xlU3VibWl0QnRuU3RhdGUiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZW5hYmxlVmFsaWRhdGlvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlUG9wdXAiLCJfcG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZU92ZXJsYXlDbGljayIsIm9wZW5Qb3B1cCIsIl9hZGRDbG9zZU9uQ2xpY2tFdmVudCIsIl9jbG9zZUJ0biIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm0iLCJfYnV0dG9uVmFsdWUiLCJfaW5wdXRMaXN0IiwiX2J1dHRvbiIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJyZW5kZXJMb2FkaW5nIiwic2V0U3VibWl0RGF0YSIsImlzTG9hZGluZyIsInJlc2V0IiwicHJvZmlsZUVkaXRCdG4iLCJwcm9maWxlQWRkQnRuIiwicHJvZmlsZUlucHV0TmFtZSIsInByb2ZpbGVJbnB1dEhvYmJ5IiwicHJvZmlsZVBvcHVwRm9ybSIsImNhcmRQb3B1cEZvcm0iLCJhdmF0YXJQb3B1cEZvcm0iLCJwcm9maWxlT3ZlcmxheUNvbnRhaW5lciIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwidXJsIiwibG9hZFVzZXJJbmZvIiwiZmV0Y2giLCJhdXRob3JpemF0aW9uIiwidGhlbiIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImVkaXRQcm9maWxlRGF0YSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhZGROZXdDYXJkIiwiZGVsZXRlQ2FyZCIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsImNoYW5nZVByb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJlbGVtZW50c1NlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJjYXJkSXRlbSIsInJlbmRlckNhcmQiLCJ1c2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VySm9iU2VsZWN0b3IiLCJ1c2VyQXZhdGFyU2VsZWN0b3IiLCJfdXNlck5hbWUiLCJfdXNlckpvYiIsIl91c2VyQXZhdGFyIiwiZ2V0VXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJKb2IiLCJ1c2VyQXZhdGFyIiwic2V0VXNlckluZm8iLCJqb2IiLCJwcm9maWxlSW1hZ2VMaW5rIiwiY29uZmlybURlbGV0ZVBvcHVwIiwicmVzdWx0IiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsImF2YXRhclBvcHVwIiwiZGF0YSIsImNhcmRJbWFnZVBvcHVwIiwiX3BvcHVwSW1hZ2VFbGVtZW50IiwiX3BvcHVwTmFtZUVsZW1lbnQiLCJfYWRkSW1hZ2VBbmRDYXB0aW9uIiwiY2FyZFBvcHVwIiwidGl0bGUiLCJpbWFnZV9saW5rIiwiY2FyZCIsInByb2ZpbGVQb3B1cCIsImhvYmJ5IiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwibGlrZWQiLCJ1cGRhdGVDYXJkIiwiaGFuZGxlRGVsZXRlSWNvbkNsaWNrIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImZpbGxQcm9maWxlSW5wdXRzIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkcyJdLCJzb3VyY2VSb290IjoiIn0=